<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>My First Website</title>
  <link rel="shortcut icon" href=”../images/vfx-logo.png”> 
  <link rel="stylesheet" href="../styles.css">
  <script type="module" src="https://md-block.verou.me/md-block.js"></script>
</head>

<div style="background-color: white; background-size: cover; height:380px; padding-top:20px; text-align: center;">
    <h1 style="font-size:32px; color:black; margin:10px;">Elad Damian Nachman</h1>
    <img src="../images/vfx-logo-animation.gif" style="height:250px; border-radius: 50%; " alt="vfx logo">
    <p style="font-size: 20px; color:#1F9AFE; margin: 10px;">
        <a href="https://github.com/eldnach?tab=repositories">Github</a>
        <a href="https://dn3d.artstation.com/">ArtStation</a>
        <a href="https://www.shadertoy.com/user/lerping/sort=newest">ShaderToy</a>
        <a href="https://www.linkedin.com/in/eldnach/">LinkedIn</a>
    </p>
</div>

<div class="row">
    <div class="leftcolumn">
        <div class= "post">
            <md-block>
                # Shader Variant Tracing
               
                Track and manage shader permutations in the Unity Editor:
                * Trace the shader variants generated by your project at build time. 
                * Analyze the traces and identify Which shaders and keywords generate the most permutations.
                * Identify effective ways to reduce shader build times.
                        
                <p align="center">
                    <img width="100%" src="https://github.com/eldnach/shader-variant-analysis/blob/main/.github/images/shader-variant-analysis.png?raw=true" alt="ShaderVariants">
                    </p>

                The Unity Editor generates and compiles a large amount of shader permutations at build time, based on the amount of Shader Keywords declared and evaluated in shaders. This mechanism provides runtime control over shader functionality, while maintaing optimal shader execution performance.
                Shader variant generation contributes to an expontential growth in project build times, depending on the amount of shader keywords and render pipeline features enabled:
                
                <p align="center">
                <img width="70%" src="https://github.com/eldnach/shader-variant-analysis/blob/main/.github/images/shader-build-times.jpg?raw=true" alt="ShaderBuiild">
                </p>

                It is advised to monitor the project's shader variant generation, and ensure no unnecessary variants are created at project build time. For more information on Unity's shader variant generation see https://blog.unity.com/engine-platform/2021-lts-improvements-to-shader-build-times-and-memory-usage 
                
                ## Requirements
                Supported in Unity 2021 LTS and later.
                
                ## Setup
                1. Clone the package repository "https://github.com/eldnach/shader-variant-analysis"
                2. In the Unity Editor, go to `Window > Package Manager`
                3. In the top left of the Package Manager window, click on `+ > Add package from disk` 
                4. Add the package directory
                
                Once installed, go to `Window > Analysis > Shader Variant Analysis`.
                
                ## Usage
                
                Enable the "Trace Next Build" setting (`Shader Variant Analysis > Build Settings > Trace Next Build`), in order to record your project's shader generation at build time. The trace file will be saved in your project's Asset folder, using the specified name:
                
                <p align="center">
                <img width="100%" src="https://github.com/eldnach/shader-variant-analysis/blob/main/.github/images/build-settings.png?raw=true" alt="BuildSettings">
                </p>
                
                Initiate a project build as usual. Once the build is complete, load the trace (`Shader Variant Analysis > Import Settings > Load Traces`) and analyze the result. The `Tracked Shaders` panel will list all the shader included in the build, along with their respective variant counts.
                
                <p align="center">
                <img width="100%" src="https://github.com/eldnach/shader-variant-analysis/blob/main/.github/images/shaders.png?raw=true" alt="TrackedShadesr">
                </p>
                
                You can expand the `Keywords` dropodown, in order to list all the keywords declared in a shader, and their contribution towards variant generation. Keyword tool tips reveal the render pipeline feature which enables each keyword.
                
                <p align="center">
                <img width="100%" src="https://github.com/eldnach/shader-variant-analysis/blob/main/.github/images/shader-keywords.png?raw=true" alt="TrackedKeywords">
                </p>
                
                In the above example, the "_ADDITIONAL_LIGHTS_SHADOWS" keyword is included in a large number of variants. This keyword is enabled via the "Additional Lights/Cast Shadows" settings in the Universal Render Pipeline Asset. Disabling graphics features in the project and render pipeline settings will allow the Unity Editor to filter the associated keywords and reduce shader build time. 
                
                The `Variants` dropdown reveals a detailed view on each variant generated by shader, along with the variant's subshader, pass, stage, platform and keyword set:
                
                <p align="center">
                <img width="100%" src="https://github.com/eldnach/shader-variant-analysis/blob/main/.github/images/shader-variants.png?raw=true" alt="TrackedVariants">
                </p>    
            </md-block>     
        </div>
    </div>
    <div class="rightcolumn">
        <div class="card">
            <h2>About Me</h2>
            <p>Realtime graphics enthusiant, currently working as a Technical Product Manager for Unity3D</p>
            <p>In this blog, I share some useful tools and personal projects to assist with Unity and realtime graphics development.</p
        </div>
        <div class="card">
            <h3>Posts</h3>
            <div class="postsummary">
                <a href="/posts/shadervarianttracing.html">Shader Variant Tracing and Anlysis</a>
            </div><br>
            <div class="postsummary">
                <a href="/posts/shaderperformancemetrics.html">Shader Performance Metrics</a>
            </div><br>
            <div class="postsummary">
                <a href="/posts/noisekit.html">Procedural Noise Generation</a>
            </div><br>
            <div class="postsummary">
                <a href="/posts/dockernginxunity.html">Docker/Nginx Server for Unity Players</a>
            </div><br>
        </div>
    </div>
</div>

</html>